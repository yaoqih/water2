{
   "annotations": {
      "list": [
         {
            "builtIn": 1,
            "datasource": {
               "type": "grafana",
               "uid": "-- Grafana --"
            },
            "enable": true,
            "hide": true,
            "iconColor": "rgba(0, 211, 255, 1)",
            "name": "Annotations & Alerts",
            "type": "dashboard"
         }
      ]
   },
   "editable": true,
   "id": 8,
   "panels": [
      {
         "gridPos": {
            "h": 2,
            "w": 24,
            "x": 0,
            "y": 0
         },
         "id": 1,
         "libraryPanel": {
            "name": "IoT Viewer Navigation",
            "uid": "lib_iot_view_nav"
         },
         "options": {
            "content": "[üè† ÊÄªËßà](/d/iot-v1-admin-home) ¬∑ [üßæ ÂØºÂá∫](/d/iot-v1-admin-export) ¬∑ [üìà ÁõëÊµãÂ§ßÂ±è](/d/iot-v1-plant-monitor)",
            "mode": "markdown"
         },
         "title": "ÂØºËà™",
         "type": "text"
      },
      {
         "gridPos": {
            "h": 1,
            "w": 24,
            "x": 0,
            "y": 2
         },
         "id": 111,
         "options": {
            "content": "üü® **ÂÖ•Âè£ÂÆûÊó∂ÔºàÈªÑËâ≤Ôºâ**",
            "mode": "markdown"
         },
         "title": "ÂÖ•Âè£Ê†áËØÜ",
         "type": "text"
      },
      {
         "datasource": "TimescaleDB-RO",
         "fieldConfig": {
            "defaults": {
               "color": {
                  "fixedColor": "#F2CC0C",
                  "mode": "fixed"
               },
               "links": [
                  {
                     "targetBlank": false,
                     "title": "ÂàáÊç¢ÂΩìÂâçÊåáÊ†á",
                     "url": "/d/iot-v1-plant-monitor?var-plant_id=${plant_id:percentencode}&var-metric=${metric_cards:percentencode}&var-agg=${agg:percentencode}"
                  }
               ],
               "thresholds": {
                  "mode": "absolute",
                  "steps": [
                     {
                        "color": "#F2CC0C",
                        "value": null
                     }
                  ]
               }
            },
            "overrides": [ ]
         },
         "gridPos": {
            "h": 3,
            "w": 1,
            "x": 0,
            "y": 3
         },
         "id": 11,
         "maxPerRow": 24,
         "options": {
            "colorMode": "value",
            "graphMode": "none",
            "justifyMode": "auto",
            "orientation": "auto",
            "reduceOptions": {
               "calcs": [
                  "lastNotNull"
               ],
               "fields": "",
               "values": false
            },
            "textMode": "value"
         },
         "repeat": "metric_cards",
         "repeatDirection": "h",
         "targets": [
            {
               "format": "table",
               "rawQuery": true,
               "rawSql": "WITH latest AS (\n  SELECT m.ingest_ts, m.value_num, m.device_id\n  FROM metric_sample m\n  WHERE m.plant_id = ${plant_id:sqlstring}\n    AND m.point_id = ${inlet_point_id:sqlstring}\n    AND m.metric = ${metric_cards:sqlstring}\n  ORDER BY m.ingest_ts DESC\n  LIMIT 1\n)\nSELECT round(l.value_num::numeric, 3) AS value\nFROM latest l\nLEFT JOIN device d ON d.device_id = l.device_id\nWHERE l.ingest_ts >= now() - ((2 * COALESCE(d.report_interval_sec, 60)) * interval '1 second');",
               "refId": "A"
            }
         ],
         "title": "${metric_cards:text}",
         "type": "stat"
      },
      {
         "gridPos": {
            "h": 1,
            "w": 24,
            "x": 0,
            "y": 6
         },
         "id": 112,
         "options": {
            "content": "üü© **Âá∫Âè£ÂÆûÊó∂ÔºàÁªøËâ≤Ôºâ**",
            "mode": "markdown"
         },
         "title": "Âá∫Âè£Ê†áËØÜ",
         "type": "text"
      },
      {
         "datasource": "TimescaleDB-RO",
         "fieldConfig": {
            "defaults": {
               "color": {
                  "fixedColor": "#73BF69",
                  "mode": "fixed"
               },
               "links": [
                  {
                     "targetBlank": false,
                     "title": "ÂàáÊç¢ÂΩìÂâçÊåáÊ†á",
                     "url": "/d/iot-v1-plant-monitor?var-plant_id=${plant_id:percentencode}&var-metric=${metric_cards:percentencode}&var-agg=${agg:percentencode}"
                  }
               ],
               "thresholds": {
                  "mode": "absolute",
                  "steps": [
                     {
                        "color": "#73BF69",
                        "value": null
                     }
                  ]
               }
            },
            "overrides": [ ]
         },
         "gridPos": {
            "h": 3,
            "w": 1,
            "x": 0,
            "y": 7
         },
         "id": 12,
         "maxPerRow": 24,
         "options": {
            "colorMode": "value",
            "graphMode": "none",
            "justifyMode": "auto",
            "orientation": "auto",
            "reduceOptions": {
               "calcs": [
                  "lastNotNull"
               ],
               "fields": "",
               "values": false
            },
            "textMode": "value"
         },
         "repeat": "metric_cards",
         "repeatDirection": "h",
         "targets": [
            {
               "format": "table",
               "rawQuery": true,
               "rawSql": "WITH latest AS (\n  SELECT m.ingest_ts, m.value_num, m.device_id\n  FROM metric_sample m\n  WHERE m.plant_id = ${plant_id:sqlstring}\n    AND m.point_id = ${outlet_point_id:sqlstring}\n    AND m.metric = ${metric_cards:sqlstring}\n  ORDER BY m.ingest_ts DESC\n  LIMIT 1\n)\nSELECT round(l.value_num::numeric, 3) AS value\nFROM latest l\nLEFT JOIN device d ON d.device_id = l.device_id\nWHERE l.ingest_ts >= now() - ((2 * COALESCE(d.report_interval_sec, 60)) * interval '1 second');",
               "refId": "A"
            }
         ],
         "title": "${metric_cards:text}",
         "type": "stat"
      },
      {
         "gridPos": {
            "h": 32,
            "w": 8,
            "x": 0,
            "y": 10
         },
         "id": 301,
         "options": {
            "content": "<iframe src=\"/d/iot-v1-plant-monitor-left24h/iot-v1-plant-monitor-left24h?kiosk=1&from=now-24h&to=now&var-plant_id=${plant_id:percentencode}&var-inlet_point_id=${inlet_point_id:percentencode}&var-outlet_point_id=${outlet_point_id:percentencode}\" width=\"100%\" height=\"100%\" frameborder=\"0\" scrolling=\"yes\"></iframe>",
            "mode": "html"
         },
         "title": " ",
         "type": "text"
      },
      {
         "gridPos": {
            "h": 4,
            "w": 16,
            "x": 8,
            "y": 10
         },
         "id": 16,
         "options": {
            "content": "ÂΩìÂâçÊåáÊ†áÔºö**${metric:text}** ÔΩú ÂΩìÂâçÂë®ÊúüÔºö**${agg}**\n\nËÅöÂêàÂë®ÊúüÂàáÊç¢Ôºö[5ÂàÜÈíü](/d/iot-v1-plant-monitor?var-plant_id=${plant_id:percentencode}&var-metric=${metric:percentencode}&var-agg=5min&var-mean_page=${mean_page:percentencode}) ¬∑ [Â∞èÊó∂](/d/iot-v1-plant-monitor?var-plant_id=${plant_id:percentencode}&var-metric=${metric:percentencode}&var-agg=hour&var-mean_page=${mean_page:percentencode}) ¬∑ [Â§©](/d/iot-v1-plant-monitor?var-plant_id=${plant_id:percentencode}&var-metric=${metric:percentencode}&var-agg=day&var-mean_page=${mean_page:percentencode}) ¬∑ [Êúà](/d/iot-v1-plant-monitor?var-plant_id=${plant_id:percentencode}&var-metric=${metric:percentencode}&var-agg=month&var-mean_page=${mean_page:percentencode})\n\nÊåáÊ†áÂàáÊç¢Ôºö${metric_switch_md:raw}",
            "mode": "markdown"
         },
         "title": "Ëú°ÁÉõÂõæÂë®ÊúüÊåáÊ†áÈÄâÊã©",
         "type": "text"
      },
      {
         "datasource": "TimescaleDB-RO",
         "fieldConfig": {
            "defaults": {
               "unit": "short"
            },
            "overrides": [
               {
                  "matcher": {
                     "id": "byName",
                     "options": "ÂëäË≠¶‰∏ãÈôêÁ∫ø"
                  },
                  "properties": [
                     {
                        "id": "color",
                        "value": {
                           "fixedColor": "#FF9830",
                           "mode": "fixed"
                        }
                     },
                     {
                        "id": "custom.drawStyle",
                        "value": "line"
                     },
                     {
                        "id": "custom.lineWidth",
                        "value": 2
                     },
                     {
                        "id": "custom.lineInterpolation",
                        "value": "linear"
                     },
                     {
                        "id": "custom.fillOpacity",
                        "value": 0
                     },
                     {
                        "id": "custom.showPoints",
                        "value": "never"
                     },
                     {
                        "id": "custom.axisPlacement",
                        "value": "right"
                     }
                  ]
               },
               {
                  "matcher": {
                     "id": "byName",
                     "options": "ÂëäË≠¶‰∏äÈôêÁ∫ø"
                  },
                  "properties": [
                     {
                        "id": "color",
                        "value": {
                           "fixedColor": "#E02F44",
                           "mode": "fixed"
                        }
                     },
                     {
                        "id": "custom.drawStyle",
                        "value": "line"
                     },
                     {
                        "id": "custom.lineWidth",
                        "value": 2
                     },
                     {
                        "id": "custom.lineInterpolation",
                        "value": "linear"
                     },
                     {
                        "id": "custom.fillOpacity",
                        "value": 0
                     },
                     {
                        "id": "custom.showPoints",
                        "value": "never"
                     },
                     {
                        "id": "custom.axisPlacement",
                        "value": "right"
                     }
                  ]
               }
            ]
         },
         "gridPos": {
            "h": 10,
            "w": 16,
            "x": 8,
            "y": 14
         },
         "id": 4,
         "options": {
            "candleStyle": "candles",
            "colorStrategy": "open-close",
            "colors": {
               "down": "#B38B00",
               "up": "#F2CC0C"
            },
            "fields": {
               "close": "close",
               "high": "high",
               "low": "low",
               "open": "open"
            },
            "includeAllFields": true,
            "legend": {
               "calcs": [ ],
               "displayMode": "list",
               "placement": "bottom"
            },
            "mode": "candles",
            "tooltip": {
               "hoverProximity": 80,
               "maxHeight": 600,
               "maxWidth": 600,
               "mode": "single",
               "sort": "none"
            }
         },
         "targets": [
            {
               "format": "table",
               "rawQuery": true,
               "rawSql": "WITH base AS (\n  SELECT CASE ${agg:sqlstring}\n           WHEN '5min' THEN to_timestamp(floor(extract(epoch FROM m.ingest_ts) / 300) * 300)\n           ELSE date_trunc(CASE ${agg:sqlstring}\n                  WHEN 'hour' THEN 'hour'\n                  WHEN 'day' THEN 'day'\n                  WHEN 'month' THEN 'month'\n                  ELSE 'hour' END, m.ingest_ts)\n         END AS bucket_ts,\n         m.ingest_ts,\n         m.value_num\n  FROM metric_sample m\n  WHERE m.plant_id = ${plant_id:sqlstring}\n    AND m.metric = ${metric:sqlstring}\n    AND EXISTS (\n      SELECT 1 FROM metric_dict md\n      WHERE md.metric = m.metric\n        AND md.visible IS TRUE\n    )\n    AND m.point_id = ${inlet_point_id:sqlstring}\n), ohlc AS (\n  SELECT bucket_ts,\n         CASE ${agg:sqlstring}\n           WHEN '5min' THEN bucket_ts + interval '5 minutes'\n           WHEN 'hour' THEN bucket_ts + interval '1 hour'\n           WHEN 'day' THEN bucket_ts + interval '1 day'\n           WHEN 'month' THEN bucket_ts + interval '1 month'\n           ELSE bucket_ts + interval '1 hour'\n         END AS bucket_end,\n         (array_agg(value_num ORDER BY ingest_ts ASC))[1] AS open,\n         max(value_num) AS high,\n         min(value_num) AS low,\n         (array_agg(value_num ORDER BY ingest_ts DESC))[1] AS close\n  FROM base\n  GROUP BY bucket_ts\n)\nSELECT (bucket_ts + ((bucket_end - bucket_ts) / 2.0)) AS \"time\",\n       COALESCE(open, close) AS open,\n       high,\n       low,\n       close\nFROM ohlc\nORDER BY \"time\";",
               "refId": "A"
            },
            {
               "format": "time_series",
               "rawQuery": true,
               "rawSql": "WITH bounds AS (\n  SELECT min(m.ingest_ts) AS from_ts,\n         max(m.ingest_ts) AS to_ts\n  FROM metric_sample m\n  WHERE m.plant_id = ${plant_id:sqlstring}\n    AND m.metric = ${metric:sqlstring}\n    AND EXISTS (\n      SELECT 1 FROM metric_dict md\n      WHERE md.metric = m.metric\n        AND md.visible IS TRUE\n    )\n    AND m.point_id = ${inlet_point_id:sqlstring}\n), alarm AS (\n  SELECT md.alarm_low::double precision AS alarm_low,\n         md.alarm_high::double precision AS alarm_high\n  FROM metric_dict md\n  WHERE md.metric = ${metric:sqlstring}\n    AND md.visible IS TRUE\n  LIMIT 1\n)\nSELECT bounds.from_ts AS \"time\",\n       alarm.alarm_low AS \"ÂëäË≠¶‰∏ãÈôêÁ∫ø\",\n       alarm.alarm_high AS \"ÂëäË≠¶‰∏äÈôêÁ∫ø\"\nFROM bounds\nJOIN alarm ON true\nWHERE bounds.from_ts IS NOT NULL\nUNION ALL\nSELECT bounds.to_ts AS \"time\",\n       alarm.alarm_low AS \"ÂëäË≠¶‰∏ãÈôêÁ∫ø\",\n       alarm.alarm_high AS \"ÂëäË≠¶‰∏äÈôêÁ∫ø\"\nFROM bounds\nJOIN alarm ON true\nWHERE bounds.to_ts IS NOT NULL\nORDER BY 1;",
               "refId": "B"
            }
         ],
         "hideTimeOverride": true,
         "timeFrom": "${candle_span_sec}s",
         "timeShift": "${candle_lag_sec}s",
         "title": "ÂÖ•Âè£Ëú°ÁÉõÂõæÔºà${metric:text}ÔΩúÂëäË≠¶‰∏ãÈôê:${metric_alarm_low:text} ‰∏äÈôê:${metric_alarm_high:text}Ôºâ",
         "type": "candlestick"
      },
      {
         "datasource": "TimescaleDB-RO",
         "fieldConfig": {
            "defaults": {
               "unit": "short"
            },
            "overrides": [
               {
                  "matcher": {
                     "id": "byName",
                     "options": "ÂëäË≠¶‰∏ãÈôêÁ∫ø"
                  },
                  "properties": [
                     {
                        "id": "color",
                        "value": {
                           "fixedColor": "#FF9830",
                           "mode": "fixed"
                        }
                     },
                     {
                        "id": "custom.drawStyle",
                        "value": "line"
                     },
                     {
                        "id": "custom.lineWidth",
                        "value": 2
                     },
                     {
                        "id": "custom.lineInterpolation",
                        "value": "linear"
                     },
                     {
                        "id": "custom.fillOpacity",
                        "value": 0
                     },
                     {
                        "id": "custom.showPoints",
                        "value": "never"
                     },
                     {
                        "id": "custom.axisPlacement",
                        "value": "right"
                     }
                  ]
               },
               {
                  "matcher": {
                     "id": "byName",
                     "options": "ÂëäË≠¶‰∏äÈôêÁ∫ø"
                  },
                  "properties": [
                     {
                        "id": "color",
                        "value": {
                           "fixedColor": "#E02F44",
                           "mode": "fixed"
                        }
                     },
                     {
                        "id": "custom.drawStyle",
                        "value": "line"
                     },
                     {
                        "id": "custom.lineWidth",
                        "value": 2
                     },
                     {
                        "id": "custom.lineInterpolation",
                        "value": "linear"
                     },
                     {
                        "id": "custom.fillOpacity",
                        "value": 0
                     },
                     {
                        "id": "custom.showPoints",
                        "value": "never"
                     },
                     {
                        "id": "custom.axisPlacement",
                        "value": "right"
                     }
                  ]
               }
            ]
         },
         "gridPos": {
            "h": 10,
            "w": 16,
            "x": 8,
            "y": 24
         },
         "id": 17,
         "options": {
            "candleStyle": "candles",
            "colorStrategy": "open-close",
            "colors": {
               "down": "#2D7D46",
               "up": "#73BF69"
            },
            "fields": {
               "close": "close",
               "high": "high",
               "low": "low",
               "open": "open"
            },
            "includeAllFields": true,
            "legend": {
               "calcs": [ ],
               "displayMode": "list",
               "placement": "bottom"
            },
            "mode": "candles",
            "tooltip": {
               "hoverProximity": 80,
               "maxHeight": 600,
               "maxWidth": 600,
               "mode": "single",
               "sort": "none"
            }
         },
         "targets": [
            {
               "format": "table",
               "rawQuery": true,
               "rawSql": "WITH base AS (\n  SELECT CASE ${agg:sqlstring}\n           WHEN '5min' THEN to_timestamp(floor(extract(epoch FROM m.ingest_ts) / 300) * 300)\n           ELSE date_trunc(CASE ${agg:sqlstring}\n                  WHEN 'hour' THEN 'hour'\n                  WHEN 'day' THEN 'day'\n                  WHEN 'month' THEN 'month'\n                  ELSE 'hour' END, m.ingest_ts)\n         END AS bucket_ts,\n         m.ingest_ts,\n         m.value_num\n  FROM metric_sample m\n  WHERE m.plant_id = ${plant_id:sqlstring}\n    AND m.metric = ${metric:sqlstring}\n    AND EXISTS (\n      SELECT 1 FROM metric_dict md\n      WHERE md.metric = m.metric\n        AND md.visible IS TRUE\n    )\n    AND m.point_id = ${outlet_point_id:sqlstring}\n), ohlc AS (\n  SELECT bucket_ts,\n         CASE ${agg:sqlstring}\n           WHEN '5min' THEN bucket_ts + interval '5 minutes'\n           WHEN 'hour' THEN bucket_ts + interval '1 hour'\n           WHEN 'day' THEN bucket_ts + interval '1 day'\n           WHEN 'month' THEN bucket_ts + interval '1 month'\n           ELSE bucket_ts + interval '1 hour'\n         END AS bucket_end,\n         (array_agg(value_num ORDER BY ingest_ts ASC))[1] AS open,\n         max(value_num) AS high,\n         min(value_num) AS low,\n         (array_agg(value_num ORDER BY ingest_ts DESC))[1] AS close\n  FROM base\n  GROUP BY bucket_ts\n)\nSELECT (bucket_ts + ((bucket_end - bucket_ts) / 2.0)) AS \"time\",\n       COALESCE(open, close) AS open,\n       high,\n       low,\n       close\nFROM ohlc\nORDER BY \"time\";",
               "refId": "A"
            },
            {
               "format": "time_series",
               "rawQuery": true,
               "rawSql": "WITH bounds AS (\n  SELECT min(m.ingest_ts) AS from_ts,\n         max(m.ingest_ts) AS to_ts\n  FROM metric_sample m\n  WHERE m.plant_id = ${plant_id:sqlstring}\n    AND m.metric = ${metric:sqlstring}\n    AND EXISTS (\n      SELECT 1 FROM metric_dict md\n      WHERE md.metric = m.metric\n        AND md.visible IS TRUE\n    )\n    AND m.point_id = ${outlet_point_id:sqlstring}\n), alarm AS (\n  SELECT md.alarm_low::double precision AS alarm_low,\n         md.alarm_high::double precision AS alarm_high\n  FROM metric_dict md\n  WHERE md.metric = ${metric:sqlstring}\n    AND md.visible IS TRUE\n  LIMIT 1\n)\nSELECT bounds.from_ts AS \"time\",\n       alarm.alarm_low AS \"ÂëäË≠¶‰∏ãÈôêÁ∫ø\",\n       alarm.alarm_high AS \"ÂëäË≠¶‰∏äÈôêÁ∫ø\"\nFROM bounds\nJOIN alarm ON true\nWHERE bounds.from_ts IS NOT NULL\nUNION ALL\nSELECT bounds.to_ts AS \"time\",\n       alarm.alarm_low AS \"ÂëäË≠¶‰∏ãÈôêÁ∫ø\",\n       alarm.alarm_high AS \"ÂëäË≠¶‰∏äÈôêÁ∫ø\"\nFROM bounds\nJOIN alarm ON true\nWHERE bounds.to_ts IS NOT NULL\nORDER BY 1;",
               "refId": "B"
            }
         ],
         "hideTimeOverride": true,
         "timeFrom": "${candle_span_sec}s",
         "timeShift": "${candle_lag_sec}s",
         "title": "Âá∫Âè£Ëú°ÁÉõÂõæÔºà${metric:text}ÔΩúÂëäË≠¶‰∏ãÈôê:${metric_alarm_low:text} ‰∏äÈôê:${metric_alarm_high:text}Ôºâ",
         "type": "candlestick"
      },
      {
         "datasource": "TimescaleDB-RO",
         "fieldConfig": {
            "defaults": {
               "custom": {
                  "drawStyle": "line",
                  "fillOpacity": 30,
                  "lineInterpolation": "smooth",
                  "lineWidth": 2,
                  "showPoints": "never",
                  "spanNulls": true
               }
            },
            "overrides": [
               {
                  "matcher": {
                     "id": "byName",
                     "options": "ÂÖ•Âè£"
                  },
                  "properties": [
                     {
                        "id": "color",
                        "value": {
                           "fixedColor": "#F2CC0C",
                           "mode": "fixed"
                        }
                     }
                  ]
               },
               {
                  "matcher": {
                     "id": "byName",
                     "options": "Âá∫Âè£"
                  },
                  "properties": [
                     {
                        "id": "color",
                        "value": {
                           "fixedColor": "#73BF69",
                           "mode": "fixed"
                        }
                     }
                  ]
               }
            ]
         },
         "gridPos": {
            "h": 6,
            "w": 16,
            "x": 8,
            "y": 34
         },
         "hideTimeOverride": true,
         "id": 14,
         "options": {
            "legend": {
               "calcs": [ ],
               "displayMode": "list",
               "placement": "bottom"
            },
            "tooltip": {
               "mode": "multi",
               "sort": "none"
            }
         },
         "targets": [
            {
               "format": "time_series",
               "rawQuery": true,
               "rawSql": "WITH base AS (\n  SELECT m.ingest_ts,\n         m.point_id,\n         m.value_num,\n         row_number() OVER (PARTITION BY m.point_id ORDER BY m.ingest_ts) AS rn,\n         count(*) OVER (PARTITION BY m.point_id) AS total_rows\n  FROM metric_sample m\n  WHERE m.plant_id = ${plant_id:sqlstring}\n    AND m.metric = ${metric:sqlstring}\n    AND EXISTS (\n      SELECT 1 FROM metric_dict md\n      WHERE md.metric = m.metric\n        AND md.visible IS TRUE\n    )\n    AND m.point_id IN (${inlet_point_id:sqlstring}, ${outlet_point_id:sqlstring})\n), sampled AS (\n  SELECT ingest_ts AS \"time\", point_id, value_num AS value\n  FROM base\n  WHERE total_rows <= 2000\n     OR rn = 1\n     OR rn = total_rows\n     OR (rn % GREATEST(1::bigint, ceil(total_rows / 1000.0)::bigint)) = 0\n)\nSELECT s.\"time\",\n       CASE WHEN s.point_id = ${inlet_point_id:sqlstring} THEN 'ÂÖ•Âè£' ELSE 'Âá∫Âè£' END AS metric,\n       s.value\nFROM sampled s\nORDER BY s.\"time\";",
               "refId": "A"
            }
         ],
         "timeFrom": "${candle_span_sec}s",
         "timeShift": "${candle_lag_sec}s",
         "title": "Êó∂Èó¥ËåÉÂõ¥ÂØºËà™ÔºàÂÖ®ÈáèÔºöÊãñÊãΩÁº©Â∞è / ÂèåÂáªÊÅ¢Â§çÔºâ",
         "type": "timeseries"
      },
      {
         "gridPos": {
            "h": 2,
            "w": 16,
            "x": 8,
            "y": 40
         },
         "id": 15,
         "options": {
            "content": "Êìç‰ΩúÔºöÂè≥‰æßÂØºËà™Âõæ**ÊãñÊãΩ=Áº©Â∞è**Ôºå**ÂèåÂáªÂõæË°®=ÊÅ¢Â§çÂà∞ÂΩìÂâçÁ™óÂè£**ÔºõËú°ÁÉõÂõæ‰∏äÊñπÂèØÂø´Êç∑ÂàáÊç¢ÊåáÊ†á‰∏éÂë®Êúü„ÄÇÊ≥®ÊÑèÔºöÂÆûÊó∂Âç°ÁâáÊåâËÆæÂ§á‰∏äÊä•Âë®ÊúüÂà§Êñ≠Êñ∞È≤úÂ∫¶ÔºåË∂ÖËøá **2 √ó report_interval_sec** Êú™Êî∂Âà∞Êñ∞Êï∞ÊçÆÂ∞ÜÊòæÁ§∫ **No data**„ÄÇ",
            "mode": "markdown"
         },
         "title": "Êó∂Èó¥ËåÉÂõ¥ÊéßÂà∂",
         "type": "text"
      }
   ],
   "refresh": "30s",
   "schemaVersion": 39,
   "tags": [
      "iot",
      "monitor",
      "plant"
   ],
   "templating": {
      "list": [
         {
            "current": {
               "selected": true,
               "text": "plant_cqbb_liaoning53",
               "value": "plant_cqbb_liaoning53"
            },
            "datasource": "TimescaleDB-RO",
            "definition": "SELECT p.plant_id AS __value,\n       COALESCE(NULLIF(btrim(p.plant_name), ''), p.plant_id) AS __text\nFROM plant p\nORDER BY __text;",
            "hide": 0,
            "includeAll": false,
            "label": "Ê∞¥ÂéÇ",
            "multi": false,
            "name": "plant_id",
            "options": [ ],
            "query": "SELECT p.plant_id AS __value,\n       COALESCE(NULLIF(btrim(p.plant_name), ''), p.plant_id) AS __text\nFROM plant p\nORDER BY __text;",
            "refresh": 1,
            "regex": "",
            "skipUrlSync": false,
            "sort": 1,
            "type": "query"
         },
         {
            "current": {
               "selected": true,
               "text": "pt_cqbb_liaoning53_inlet",
               "value": "pt_cqbb_liaoning53_inlet"
            },
            "datasource": "TimescaleDB-RO",
            "definition": "SELECT point_id FROM point WHERE plant_id = ${plant_id:sqlstring} AND point_type = 'inlet' ORDER BY point_id LIMIT 1;",
            "hide": 2,
            "includeAll": false,
            "multi": false,
            "name": "inlet_point_id",
            "options": [ ],
            "query": "SELECT point_id FROM point WHERE plant_id = ${plant_id:sqlstring} AND point_type = 'inlet' ORDER BY point_id LIMIT 1;",
            "refresh": 1,
            "regex": "",
            "skipUrlSync": true,
            "sort": 1,
            "type": "query"
         },
         {
            "current": {
               "selected": true,
               "text": "pt_cqbb_liaoning53_outlet",
               "value": "pt_cqbb_liaoning53_outlet"
            },
            "datasource": "TimescaleDB-RO",
            "definition": "SELECT point_id FROM point WHERE plant_id = ${plant_id:sqlstring} AND point_type = 'outlet' ORDER BY point_id LIMIT 1;",
            "hide": 2,
            "includeAll": false,
            "multi": false,
            "name": "outlet_point_id",
            "options": [ ],
            "query": "SELECT point_id FROM point WHERE plant_id = ${plant_id:sqlstring} AND point_type = 'outlet' ORDER BY point_id LIMIT 1;",
            "refresh": 1,
            "regex": "",
            "skipUrlSync": true,
            "sort": 1,
            "type": "query"
         },
         {
            "current": {
               "selected": true,
               "text": "Ê∏©Â∫¶",
               "value": "temperature"
            },
            "datasource": "TimescaleDB-RO",
            "definition": "SELECT md.metric AS __value, COALESCE(md.display_name, md.metric) AS __text FROM metric_dict md WHERE md.visible IS TRUE AND NULLIF(btrim(md.metric), '') IS NOT NULL ORDER BY md.metric;",
            "hide": 2,
            "includeAll": false,
            "label": "ÂΩìÂâçÊåáÊ†á",
            "multi": false,
            "name": "metric",
            "options": [ ],
            "query": "SELECT md.metric AS __value, COALESCE(md.display_name, md.metric) AS __text FROM metric_dict md WHERE md.visible IS TRUE AND NULLIF(btrim(md.metric), '') IS NOT NULL ORDER BY md.metric;",
            "refresh": 1,
            "regex": "",
            "skipUrlSync": false,
            "sort": 1,
            "type": "query"
         },
         {
            "current": {
               "selected": true,
               "text": "hour",
               "value": "hour"
            },
            "hide": 2,
            "includeAll": false,
            "label": "Âë®Êúü",
            "multi": false,
            "name": "agg",
            "options": [
               {
                  "selected": false,
                  "text": "5min",
                  "value": "5min"
               },
               {
                  "selected": true,
                  "text": "hour",
                  "value": "hour"
               },
               {
                  "selected": false,
                  "text": "day",
                  "value": "day"
               },
               {
                  "selected": false,
                  "text": "month",
                  "value": "month"
               }
            ],
            "query": "5min,hour,day,month",
            "skipUrlSync": false,
            "type": "custom"
         },
         {
            "current": {
               "selected": true,
               "text": "86400",
               "value": "86400"
            },
            "datasource": "TimescaleDB-RO",
            "definition": "SELECT COALESCE(\n         GREATEST(\n           1::bigint,\n           ceil(extract(epoch FROM (max(m.ingest_ts) - min(m.ingest_ts))))::bigint\n         ),\n         86400::bigint\n       )::text AS __text,\n       COALESCE(\n         GREATEST(\n           1::bigint,\n           ceil(extract(epoch FROM (max(m.ingest_ts) - min(m.ingest_ts))))::bigint\n         ),\n         86400::bigint\n       )::text AS __value\nFROM metric_sample m\nWHERE m.plant_id = ${plant_id:sqlstring}\n  AND m.metric = ${metric:sqlstring}\n  AND m.point_id IN (${inlet_point_id:sqlstring}, ${outlet_point_id:sqlstring})\n  AND EXISTS (\n    SELECT 1\n    FROM metric_dict md\n    WHERE md.metric = m.metric\n      AND md.visible IS TRUE\n  );",
            "hide": 2,
            "includeAll": false,
            "multi": false,
            "name": "candle_span_sec",
            "options": [ ],
            "query": "SELECT COALESCE(\n         GREATEST(\n           1::bigint,\n           ceil(extract(epoch FROM (max(m.ingest_ts) - min(m.ingest_ts))))::bigint\n         ),\n         86400::bigint\n       )::text AS __text,\n       COALESCE(\n         GREATEST(\n           1::bigint,\n           ceil(extract(epoch FROM (max(m.ingest_ts) - min(m.ingest_ts))))::bigint\n         ),\n         86400::bigint\n       )::text AS __value\nFROM metric_sample m\nWHERE m.plant_id = ${plant_id:sqlstring}\n  AND m.metric = ${metric:sqlstring}\n  AND m.point_id IN (${inlet_point_id:sqlstring}, ${outlet_point_id:sqlstring})\n  AND EXISTS (\n    SELECT 1\n    FROM metric_dict md\n    WHERE md.metric = m.metric\n      AND md.visible IS TRUE\n  );",
            "refresh": 1,
            "regex": "",
            "skipUrlSync": true,
            "sort": 1,
            "type": "query"
         },
         {
            "current": {
               "selected": true,
               "text": "0",
               "value": "0"
            },
            "datasource": "TimescaleDB-RO",
            "definition": "SELECT COALESCE(\n         GREATEST(\n           0::bigint,\n           ceil(extract(epoch FROM (now() - max(m.ingest_ts))))::bigint\n         ),\n         0::bigint\n       )::text AS __text,\n       COALESCE(\n         GREATEST(\n           0::bigint,\n           ceil(extract(epoch FROM (now() - max(m.ingest_ts))))::bigint\n         ),\n         0::bigint\n       )::text AS __value\nFROM metric_sample m\nWHERE m.plant_id = ${plant_id:sqlstring}\n  AND m.metric = ${metric:sqlstring}\n  AND m.point_id IN (${inlet_point_id:sqlstring}, ${outlet_point_id:sqlstring})\n  AND EXISTS (\n    SELECT 1\n    FROM metric_dict md\n    WHERE md.metric = m.metric\n      AND md.visible IS TRUE\n  );",
            "hide": 2,
            "includeAll": false,
            "multi": false,
            "name": "candle_lag_sec",
            "options": [ ],
            "query": "SELECT COALESCE(\n         GREATEST(\n           0::bigint,\n           ceil(extract(epoch FROM (now() - max(m.ingest_ts))))::bigint\n         ),\n         0::bigint\n       )::text AS __text,\n       COALESCE(\n         GREATEST(\n           0::bigint,\n           ceil(extract(epoch FROM (now() - max(m.ingest_ts))))::bigint\n         ),\n         0::bigint\n       )::text AS __value\nFROM metric_sample m\nWHERE m.plant_id = ${plant_id:sqlstring}\n  AND m.metric = ${metric:sqlstring}\n  AND m.point_id IN (${inlet_point_id:sqlstring}, ${outlet_point_id:sqlstring})\n  AND EXISTS (\n    SELECT 1\n    FROM metric_dict md\n    WHERE md.metric = m.metric\n      AND md.visible IS TRUE\n  );",
            "refresh": 1,
            "regex": "",
            "skipUrlSync": true,
            "sort": 1,
            "type": "query"
         },
         {
            "current": {
               "selected": true,
               "text": "Êó†",
               "value": "Êó†"
            },
            "datasource": "TimescaleDB-RO",
            "definition": "SELECT COALESCE(md.alarm_low::text, 'Êó†') AS __text, COALESCE(md.alarm_low::text, 'NaN') AS __value FROM metric_dict md WHERE md.metric = ${metric:sqlstring} AND md.visible IS TRUE LIMIT 1;",
            "hide": 2,
            "includeAll": false,
            "multi": false,
            "name": "metric_alarm_low",
            "options": [ ],
            "query": "SELECT COALESCE(md.alarm_low::text, 'Êó†') AS __text, COALESCE(md.alarm_low::text, 'NaN') AS __value FROM metric_dict md WHERE md.metric = ${metric:sqlstring} AND md.visible IS TRUE LIMIT 1;",
            "refresh": 2,
            "regex": "",
            "skipUrlSync": true,
            "sort": 1,
            "type": "query"
         },
         {
            "current": {
               "selected": true,
               "text": "Êó†",
               "value": "Êó†"
            },
            "datasource": "TimescaleDB-RO",
            "definition": "SELECT COALESCE(md.alarm_high::text, 'Êó†') AS __text, COALESCE(md.alarm_high::text, 'NaN') AS __value FROM metric_dict md WHERE md.metric = ${metric:sqlstring} AND md.visible IS TRUE LIMIT 1;",
            "hide": 2,
            "includeAll": false,
            "multi": false,
            "name": "metric_alarm_high",
            "options": [ ],
            "query": "SELECT COALESCE(md.alarm_high::text, 'Êó†') AS __text, COALESCE(md.alarm_high::text, 'NaN') AS __value FROM metric_dict md WHERE md.metric = ${metric:sqlstring} AND md.visible IS TRUE LIMIT 1;",
            "refresh": 2,
            "regex": "",
            "skipUrlSync": true,
            "sort": 1,
            "type": "query"
         },
         {
            "current": {
               "selected": true,
               "text": "1",
               "value": "1"
            },
            "datasource": "TimescaleDB-RO",
            "definition": "SELECT gs::text AS __text, gs::text AS __value FROM generate_series(1, GREATEST(1, ((SELECT COUNT(*) FROM metric_dict md WHERE md.visible IS TRUE AND NULLIF(btrim(md.metric), '') IS NOT NULL) + 4) / 5)) AS gs;",
            "hide": 2,
            "includeAll": false,
            "label": "ÂùáÂÄºÈ°µ",
            "multi": false,
            "name": "mean_page",
            "options": [ ],
            "query": "SELECT gs::text AS __text, gs::text AS __value FROM generate_series(1, GREATEST(1, ((SELECT COUNT(*) FROM metric_dict md WHERE md.visible IS TRUE AND NULLIF(btrim(md.metric), '') IS NOT NULL) + 4) / 5)) AS gs;",
            "refresh": 1,
            "regex": "",
            "skipUrlSync": false,
            "sort": 1,
            "type": "query"
         },
         {
            "current": {
               "selected": true,
               "text": "1",
               "value": "1"
            },
            "datasource": "TimescaleDB-RO",
            "definition": "SELECT GREATEST(1, ((COUNT(*) + 4) / 5))::text AS __text, GREATEST(1, ((COUNT(*) + 4) / 5))::text AS __value FROM metric_dict md WHERE md.visible IS TRUE AND NULLIF(btrim(md.metric), '') IS NOT NULL;",
            "hide": 2,
            "includeAll": false,
            "multi": false,
            "name": "mean_page_total",
            "options": [ ],
            "query": "SELECT GREATEST(1, ((COUNT(*) + 4) / 5))::text AS __text, GREATEST(1, ((COUNT(*) + 4) / 5))::text AS __value FROM metric_dict md WHERE md.visible IS TRUE AND NULLIF(btrim(md.metric), '') IS NOT NULL;",
            "refresh": 2,
            "regex": "",
            "skipUrlSync": true,
            "sort": 1,
            "type": "query"
         },
         {
            "current": {
               "selected": true,
               "text": "1",
               "value": "1"
            },
            "datasource": "TimescaleDB-RO",
            "definition": "SELECT GREATEST(1, (${mean_page:sqlstring})::int - 1)::text AS __text, GREATEST(1, (${mean_page:sqlstring})::int - 1)::text AS __value;",
            "hide": 2,
            "includeAll": false,
            "multi": false,
            "name": "mean_page_prev",
            "options": [ ],
            "query": "SELECT GREATEST(1, (${mean_page:sqlstring})::int - 1)::text AS __text, GREATEST(1, (${mean_page:sqlstring})::int - 1)::text AS __value;",
            "refresh": 2,
            "regex": "",
            "skipUrlSync": true,
            "sort": 1,
            "type": "query"
         },
         {
            "current": {
               "selected": true,
               "text": "1",
               "value": "1"
            },
            "datasource": "TimescaleDB-RO",
            "definition": "SELECT LEAST((${mean_page_total:sqlstring})::int, (${mean_page:sqlstring})::int + 1)::text AS __text, LEAST((${mean_page_total:sqlstring})::int, (${mean_page:sqlstring})::int + 1)::text AS __value;",
            "hide": 2,
            "includeAll": false,
            "multi": false,
            "name": "mean_page_next",
            "options": [ ],
            "query": "SELECT LEAST((${mean_page_total:sqlstring})::int, (${mean_page:sqlstring})::int + 1)::text AS __text, LEAST((${mean_page_total:sqlstring})::int, (${mean_page:sqlstring})::int + 1)::text AS __value;",
            "refresh": 2,
            "regex": "",
            "skipUrlSync": true,
            "sort": 1,
            "type": "query"
         },
         {
            "current": {
               "selected": true,
               "text": "All",
               "value": "$__all"
            },
            "datasource": "TimescaleDB-RO",
            "definition": "WITH md_base AS (\n  SELECT md.metric,\n         COALESCE(NULLIF(btrim(md.display_name), ''), md.metric) AS metric_text\n  FROM metric_dict md\n  WHERE md.visible IS TRUE\n    AND NULLIF(btrim(md.metric), '') IS NOT NULL\n), md_named AS (\n  SELECT metric,\n         metric_text,\n         COUNT(*) OVER (PARTITION BY metric_text) AS text_dup_count\n  FROM md_base\n)\nSELECT metric AS __value,\n       CASE\n         WHEN text_dup_count > 1 THEN metric_text || ' [' || metric || ']'\n         ELSE metric_text\n       END AS __text\nFROM md_named\nORDER BY metric\nLIMIT 5 OFFSET (((${mean_page:sqlstring})::int - 1) * 5);",
            "hide": 2,
            "includeAll": true,
            "multi": false,
            "name": "mean_metric_page",
            "options": [ ],
            "query": "WITH md_base AS (\n  SELECT md.metric,\n         COALESCE(NULLIF(btrim(md.display_name), ''), md.metric) AS metric_text\n  FROM metric_dict md\n  WHERE md.visible IS TRUE\n    AND NULLIF(btrim(md.metric), '') IS NOT NULL\n), md_named AS (\n  SELECT metric,\n         metric_text,\n         COUNT(*) OVER (PARTITION BY metric_text) AS text_dup_count\n  FROM md_base\n)\nSELECT metric AS __value,\n       CASE\n         WHEN text_dup_count > 1 THEN metric_text || ' [' || metric || ']'\n         ELSE metric_text\n       END AS __text\nFROM md_named\nORDER BY metric\nLIMIT 5 OFFSET (((${mean_page:sqlstring})::int - 1) * 5);",
            "refresh": 1,
            "regex": "",
            "skipUrlSync": true,
            "sort": 1,
            "type": "query"
         },
         {
            "current": {
               "selected": true,
               "text": "All",
               "value": "$__all"
            },
            "datasource": "TimescaleDB-RO",
            "definition": "SELECT md.metric AS __value, COALESCE(md.display_name, md.metric) AS __text FROM metric_dict md WHERE md.visible IS TRUE AND NULLIF(btrim(md.metric), '') IS NOT NULL ORDER BY md.metric;",
            "hide": 2,
            "includeAll": true,
            "multi": true,
            "name": "metric_cards",
            "options": [ ],
            "query": "SELECT md.metric AS __value, COALESCE(md.display_name, md.metric) AS __text FROM metric_dict md WHERE md.visible IS TRUE AND NULLIF(btrim(md.metric), '') IS NOT NULL ORDER BY md.metric;",
            "refresh": 1,
            "regex": "",
            "skipUrlSync": false,
            "sort": 1,
            "type": "query"
         },
         {
            "current": {
               "selected": true,
               "text": "",
               "value": ""
            },
            "datasource": "TimescaleDB-RO",
            "definition": "WITH md_base AS (\n  SELECT md.metric,\n         COALESCE(NULLIF(btrim(md.display_name), ''), md.metric) AS metric_text\n  FROM metric_dict md\n  WHERE md.visible IS TRUE\n    AND NULLIF(btrim(md.metric), '') IS NOT NULL\n), links AS (\n  SELECT '[' || metric_text || '](/d/iot-v1-plant-monitor?var-plant_id=${plant_id:percentencode}&var-metric=' || metric || '&var-agg=${agg:percentencode}&var-mean_page=${mean_page:percentencode})' AS link\n  FROM md_base\n  ORDER BY metric\n)\nSELECT COALESCE(string_agg(link, ' ¬∑ '), 'Êó†ÂèØÈÄâÊåáÊ†á') AS __text,\n       COALESCE(string_agg(link, ' ¬∑ '), 'Êó†ÂèØÈÄâÊåáÊ†á') AS __value\nFROM links;",
            "hide": 2,
            "includeAll": false,
            "multi": false,
            "name": "metric_switch_md",
            "options": [ ],
            "query": "WITH md_base AS (\n  SELECT md.metric,\n         COALESCE(NULLIF(btrim(md.display_name), ''), md.metric) AS metric_text\n  FROM metric_dict md\n  WHERE md.visible IS TRUE\n    AND NULLIF(btrim(md.metric), '') IS NOT NULL\n), links AS (\n  SELECT '[' || metric_text || '](/d/iot-v1-plant-monitor?var-plant_id=${plant_id:percentencode}&var-metric=' || metric || '&var-agg=${agg:percentencode}&var-mean_page=${mean_page:percentencode})' AS link\n  FROM md_base\n  ORDER BY metric\n)\nSELECT COALESCE(string_agg(link, ' ¬∑ '), 'Êó†ÂèØÈÄâÊåáÊ†á') AS __text,\n       COALESCE(string_agg(link, ' ¬∑ '), 'Êó†ÂèØÈÄâÊåáÊ†á') AS __value\nFROM links;",
            "refresh": 1,
            "regex": "",
            "skipUrlSync": true,
            "sort": 1,
            "type": "query"
         }
      ]
   },
   "time": {
      "from": "now-24h",
      "to": "now"
   },
   "timepicker": {
      "hidden": true,
      "refresh_intervals": [
         "30s",
         "1m",
         "5m",
         "15m",
         "30m",
         "1h"
      ],
      "time_options": [
         "1h",
         "6h",
         "12h",
         "24h",
         "7d",
         "30d"
      ]
   },
   "timezone": "browser",
   "title": "IoT V1 ¬∑ Plant Monitor",
   "uid": "iot-v1-plant-monitor",
   "version": 85
}
